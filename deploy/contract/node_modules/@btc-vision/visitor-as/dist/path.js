import { BaseVisitor } from "./base.js";
import { utils } from "./index.js";
export class PathVisitor extends BaseVisitor {
    currentPath = [];
    get currentNode() {
        return this.currentPath[this.currentPath.length - 1];
    }
    get currentParent() {
        if (this.currentPath.length == 1)
            return this.currentNode;
        return this.currentPath[this.currentPath.length - 2];
    }
    get currentParentPath() {
        return this.currentPath.slice(0, this.currentPath.length - 1);
    }
    get currentGrandParentPath() {
        return this.currentPath.length < 3
            ? []
            : this.currentPath.slice(0, this.currentPath.length - 2);
    }
    _visit(node) {
        this.currentPath.push(node);
        super._visit(node);
        this.currentPath.pop();
    }
    cloneCurrentNode() {
        return utils.cloneNode(this.currentNode);
    }
    replaceCurrentNode(node) {
        Object.getOwnPropertyNames(this.currentParent).forEach((name) => {
            //@ts-ignore
            const prop = this.currentParent[name];
            if (prop == this.currentNode) {
                //@ts-ignore
                this.currentParent[name] = node;
            }
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGF0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9wYXRoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDeEMsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFlBQVksQ0FBQztBQUVuQyxNQUFNLE9BQU8sV0FBWSxTQUFRLFdBQVc7SUFDeEMsV0FBVyxHQUFXLEVBQUUsQ0FBQztJQUV6QixJQUFJLFdBQVc7UUFDWCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUVELElBQUksYUFBYTtRQUNiLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLElBQUksQ0FBQztZQUFFLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQztRQUMxRCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUVELElBQUksaUJBQWlCO1FBQ2pCLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ2xFLENBQUM7SUFFRCxJQUFJLHNCQUFzQjtRQUN0QixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLENBQUM7WUFDOUIsQ0FBQyxDQUFDLEVBQUU7WUFDSixDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ2pFLENBQUM7SUFFRCxNQUFNLENBQUMsSUFBVTtRQUNiLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVCLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUMzQixDQUFDO0lBRUQsZ0JBQWdCO1FBQ1osT0FBTyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsa0JBQWtCLENBQUMsSUFBVTtRQUN6QixNQUFNLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1lBQzVELFlBQVk7WUFDWixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3RDLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDM0IsWUFBWTtnQkFDWixJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQztZQUNwQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOb2RlLCB9IGZyb20gXCJAYnRjLXZpc2lvbi9hc3NlbWJseXNjcmlwdC9kaXN0L2Fzc2VtYmx5c2NyaXB0LmpzXCI7XHJcblxyXG5pbXBvcnQgeyBCYXNlVmlzaXRvciB9IGZyb20gXCIuL2Jhc2UuanNcIjtcclxuaW1wb3J0IHsgdXRpbHMgfSBmcm9tIFwiLi9pbmRleC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBhdGhWaXNpdG9yIGV4dGVuZHMgQmFzZVZpc2l0b3Ige1xyXG4gICAgY3VycmVudFBhdGg6IE5vZGVbXSA9IFtdO1xyXG5cclxuICAgIGdldCBjdXJyZW50Tm9kZSgpOiBOb2RlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50UGF0aFt0aGlzLmN1cnJlbnRQYXRoLmxlbmd0aCAtIDFdO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBjdXJyZW50UGFyZW50KCk6IE5vZGUge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYXRoLmxlbmd0aCA9PSAxKSByZXR1cm4gdGhpcy5jdXJyZW50Tm9kZTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50UGF0aFt0aGlzLmN1cnJlbnRQYXRoLmxlbmd0aCAtIDJdO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBjdXJyZW50UGFyZW50UGF0aCgpOiBOb2RlW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRQYXRoLnNsaWNlKDAsIHRoaXMuY3VycmVudFBhdGgubGVuZ3RoIC0gMSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGN1cnJlbnRHcmFuZFBhcmVudFBhdGgoKTogTm9kZVtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50UGF0aC5sZW5ndGggPCAzXHJcbiAgICAgICAgICAgID8gW11cclxuICAgICAgICAgICAgOiB0aGlzLmN1cnJlbnRQYXRoLnNsaWNlKDAsIHRoaXMuY3VycmVudFBhdGgubGVuZ3RoIC0gMik7XHJcbiAgICB9XHJcblxyXG4gICAgX3Zpc2l0KG5vZGU6IE5vZGUpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRQYXRoLnB1c2gobm9kZSk7XHJcbiAgICAgICAgc3VwZXIuX3Zpc2l0KG5vZGUpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFBhdGgucG9wKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvbmVDdXJyZW50Tm9kZSgpOiBOb2RlIHtcclxuICAgICAgICByZXR1cm4gdXRpbHMuY2xvbmVOb2RlKHRoaXMuY3VycmVudE5vZGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcGxhY2VDdXJyZW50Tm9kZShub2RlOiBOb2RlKTogdm9pZCB7XHJcbiAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcy5jdXJyZW50UGFyZW50KS5mb3JFYWNoKChuYW1lKSA9PiB7XHJcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICBjb25zdCBwcm9wID0gdGhpcy5jdXJyZW50UGFyZW50W25hbWVdO1xyXG4gICAgICAgICAgICBpZiAocHJvcCA9PSB0aGlzLmN1cnJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhcmVudFtuYW1lXSA9IG5vZGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iXX0=