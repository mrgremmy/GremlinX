import { Bytes32, Tapleaf, Taptree, XOnlyPublicKey } from '../types.js';
export declare const LEAF_VERSION_TAPSCRIPT = 192;
export declare const MAX_TAPTREE_DEPTH = 128;
interface HashLeaf {
    hash: Bytes32;
}
interface HashBranch {
    hash: Bytes32;
    left: HashTree;
    right: HashTree;
}
interface TweakedPublicKey {
    parity: number;
    x: XOnlyPublicKey;
}
/**
 * Binary tree representing leaf, branch, and root node hashes of a Taptree.
 * Each node contains a hash, and potentially left and right branch hashes.
 * This tree is used for 2 purposes: Providing the root hash for tweaking,
 * and calculating merkle inclusion proofs when constructing a control block.
 */
export type HashTree = HashLeaf | HashBranch;
/**
 * Calculates the root hash from a given control block and leaf hash.
 * @param controlBlock - The control block.
 * @param leafHash - The leaf hash.
 * @returns The root hash.
 * @throws {TypeError} If the control block length is less than 33.
 */
export declare function rootHashFromPath(controlBlock: Uint8Array, leafHash: Uint8Array): Bytes32;
/**
 * Calculates the root hash from a P2MR control block and leaf hash.
 * P2MR control blocks have no internal pubkey, so the merkle path starts at offset 1.
 * @param controlBlock - The P2MR control block: [control_byte (1)] [merkle_path (32*m)]
 * @param leafHash - The leaf hash.
 * @returns The root hash.
 * @throws {TypeError} If the control block length is less than 1.
 */
export declare function rootHashFromPathP2MR(controlBlock: Uint8Array, leafHash: Uint8Array): Bytes32;
/**
 * Build a hash tree of merkle nodes from the scripts binary tree.
 * @param scriptTree - the tree of scripts to pairwise hash.
 */
export declare function toHashTree(scriptTree: Taptree): HashTree;
/**
 * Given a HashTree, finds the path from a particular hash to the root.
 * @param node - the root of the tree
 * @param hash - the hash to search for
 * @returns - array of sibling hashes, from leaf (inclusive) to root
 * (exclusive) needed to prove inclusion of the specified hash. undefined if no
 * path is found
 */
export declare function findScriptPath(node: HashTree, hash: Bytes32): Bytes32[] | undefined;
export declare function tapleafHash(leaf: Tapleaf): Bytes32;
export declare function tapTweakHash(pubKey: XOnlyPublicKey, h: Bytes32 | undefined): Bytes32;
export declare function tweakKey(pubKey: XOnlyPublicKey, h: Bytes32 | undefined): TweakedPublicKey | null;
/**
 * Computes the TapBranch tagged hash of two child hashes.
 *
 * @param a - First child hash (left branch).
 * @param b - Second child hash (right branch).
 * @returns The 32-byte TapBranch hash.
 */
export declare function tapBranchHash(a: Uint8Array, b: Uint8Array): Bytes32;
export {};
//# sourceMappingURL=bip341.d.ts.map