import type { PsbtInput, PsbtOutput } from 'bip174';
import type { TaprootHashCache, Transaction } from '../transaction.js';
import type { PublicKey, Satoshi, Script, XOnlyPublicKey } from '../types.js';
import type { GetScriptReturn, PrevOut, PsbtOpts } from './types.js';
/**
 * Internal PSBT cache for computed values.
 * Wraps all cache management previously handled by a plain interface + scattered helper functions.
 */
export declare class PsbtCache {
    readonly nonWitnessUtxoTxCache: Transaction[];
    readonly nonWitnessUtxoBufCache: Uint8Array[];
    readonly txInCache: Record<string, number>;
    readonly tx: Transaction;
    unsafeSignNonSegwit: boolean;
    hasSignatures: boolean;
    fee: number | undefined;
    feeRate: number | undefined;
    extractedTx: Transaction | undefined;
    prevOuts: readonly PrevOut[] | undefined;
    signingScripts: readonly Script[] | undefined;
    values: readonly Satoshi[] | undefined;
    taprootHashCache: TaprootHashCache | undefined;
    constructor(tx: Transaction);
    /**
     * Invalidates cached computed values.
     * @param scope - 'full' clears everything (for input changes), 'outputs' clears fee/extract/taproot caches
     */
    invalidate(scope: 'full' | 'outputs'): void;
    addNonWitnessTxCache(input: PsbtInput, inputIndex: number, txFromBuffer: (buf: Uint8Array) => Transaction): void;
    getNonWitnessUtxoTx(input: PsbtInput, inputIndex: number, txFromBuffer: (buf: Uint8Array) => Transaction): Transaction;
    getScriptFromUtxo(inputIndex: number, input: PsbtInput, txFromBuffer: (buf: Uint8Array) => Transaction): Script;
    getScriptAndAmountFromUtxo(inputIndex: number, input: PsbtInput, txFromBuffer: (buf: Uint8Array) => Transaction): {
        script: Script;
        value: Satoshi;
    };
    computeFee(inputs: PsbtInput[], disableOutputChecks?: boolean, txFromBuffer?: (buf: Uint8Array) => Transaction): number;
    computeFeeRate(inputs: PsbtInput[], disableOutputChecks?: boolean, txFromBuffer?: (buf: Uint8Array) => Transaction): number;
    checkFees(opts: PsbtOpts): void;
    pubkeyInInput(pubkey: PublicKey, input: PsbtInput, inputIndex: number, txFromBuffer: (buf: Uint8Array) => Transaction): boolean;
    pubkeyInOutput(pubkey: PublicKey, output: PsbtOutput, outputIndex: number): boolean;
    redeemFromFinalScriptSig(finalScript: Uint8Array | undefined): Uint8Array | undefined;
    redeemFromFinalWitnessScript(finalScript: Uint8Array | undefined): Uint8Array | undefined;
    /**
     * Finalize transaction inputs and compute fee amounts.
     * Returns computed values instead of mutating cache parameters directly.
     */
    finalizeAndComputeAmounts(inputs: PsbtInput[], tx: Transaction, mustFinalize: boolean, disableOutputChecks?: boolean, txFromBuffer?: (buf: Uint8Array) => Transaction): {
        fee: number;
        feeRate: number;
    };
    getScriptFromInput(inputIndex: number, input: PsbtInput, txFromBuffer: (buf: Uint8Array) => Transaction): GetScriptReturn;
    getPrevoutTaprootKey(inputIndex: number, input: PsbtInput, txFromBuffer: (buf: Uint8Array) => Transaction): XOnlyPublicKey | null;
}
//# sourceMappingURL=PsbtCache.d.ts.map